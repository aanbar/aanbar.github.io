
<!DOCTYPE html>


<html>
	<head>
		<meta charset="utf-8">
	    
	    <title>Zip Encoding Class &mdash; CodeIgniter 3.0-dev documentation</title>

	    <link rel="stylesheet" href="../static/asset/css/common.css" type="text/css" />
	    <link rel="stylesheet" href="../static/pygments.css" type="text/css" />
	    <script type="text/javascript">
	      var DOCUMENTATION_OPTIONS = {
	        URL_ROOT:    '../',
	        VERSION:     '3.0-dev',
	        COLLAPSE_INDEX: false,
	        FILE_SUFFIX: '.html',
	        HAS_SOURCE:  false
	      };
	    </script>
	    <script type="text/javascript" src="../static/jquery.js"></script>
	    <script type="text/javascript" src="../static/underscore.js"></script>
	    <script type="text/javascript" src="../static/doctools.js"></script>

	    <script type="text/javascript" src="../static/asset/js/method-toc.js"></script>
	    <link rel="top" title="CodeIgniter 3.0-dev documentation" href="../index.html" />
	    <link rel="up" title="Libraries" href="index.html" />
	    <link rel="next" title="Helpers" href="../helpers/index.html" />
	    <link rel="prev" title="XML-RPC and XML-RPC Server Classes" href="xmlrpc.html" /> 
	</head>
	<body>
		<div id="table-contents">
			<div class="toctree-wrapper compound">
			<function <lambda> at 0x3ff3230>
			</div>
		</div>

		<div id="brand" class="ci">
			<a href="http://codeigniter.com/"><img src="../static/asset/img/ci-logo.gif" alt="CodeIgniter"></a>
			<p>3.0-dev User Guide</p>
		</div><!-- /#brand -->

		<div id="header"><!--
	--------------------------------
	Original Google search box block
	--------------------------------
	
<form method="get" action="http://www.google.com/search">
	<fieldset>
		<input type="text" name="q" id="q" value="">
		<input type="hidden" name="as_sitesearch" id="as_sitesearch" value="codeigniter.com/user_guide/" />
		<input class="grades" type="submit" value="search">
	</fieldset>
</form>
-->


<form class="search" action="../search.html" method="get">
  <input type="text" name="q" id="q" value="" />
  <input type="submit" value="search" />
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
			<ul>
				<li><a href="../index.html">User Guide Home</a>&nbsp;&nbsp; &rsaquo;</li>
				<li><a href="index.html" accesskey="U">Libraries</a>&nbsp;&nbsp;  &rsaquo;</li>
				<li><strong>Zip Encoding Class</strong></li>
			</ul>
		</div><!-- /#header -->

		<div class="section body" id="content">
  <div class="section" id="zip-encoding-class">
<h1>Zip Encoding Class<a class="headerlink" href="#zip-encoding-class" title="Permalink to this headline">¶</a></h1>
<p>CodeIgniter&#8217;s Zip Encoding Class classes permit you to create Zip
archives. Archives can be downloaded to your desktop or saved to a
directory.</p>
<div class="contents local topic" id="contents">
<ul class="simple">
<li><a class="reference internal" href="#using-the-zip-encoding-class" id="id1">Using the Zip Encoding Class</a><ul>
<li><a class="reference internal" href="#initializing-the-class" id="id2">Initializing the Class</a></li>
<li><a class="reference internal" href="#usage-example" id="id3">Usage Example</a></li>
</ul>
</li>
<li><a class="reference internal" href="#class-reference" id="id4">Class Reference</a></li>
</ul>
</div>
<div class="custom-index container"></div><div class="section" id="using-the-zip-encoding-class">
<h2><a class="toc-backref" href="#id1">Using the Zip Encoding Class</a><a class="headerlink" href="#using-the-zip-encoding-class" title="Permalink to this headline">¶</a></h2>
<div class="section" id="initializing-the-class">
<h3><a class="toc-backref" href="#id2">Initializing the Class</a><a class="headerlink" href="#initializing-the-class" title="Permalink to this headline">¶</a></h3>
<p>Like most other classes in CodeIgniter, the Zip class is initialized in
your controller using the $this-&gt;load-&gt;library function:</p>
<div class="highlight-ci"><pre>$this-&gt;load-&gt;library('zip');</pre>
</div>
<p>Once loaded, the Zip library object will be available using: $this-&gt;zip</p>
</div>
<div class="section" id="usage-example">
<h3><a class="toc-backref" href="#id3">Usage Example</a><a class="headerlink" href="#usage-example" title="Permalink to this headline">¶</a></h3>
<p>This example demonstrates how to compress a file, save it to a folder on
your server, and download it to your desktop.</p>
<div class="highlight-ci"><pre>$name = 'mydata1.txt';
$data = 'A Data String!';

$this-&gt;zip-&gt;add_data($name, $data);

// Write the zip file to a folder on your server. Name it "my_backup.zip"
$this-&gt;zip-&gt;archive('/path/to/directory/my_backup.zip');

// Download the file to your desktop. Name it "my_backup.zip"
$this-&gt;zip-&gt;download('my_backup.zip');</pre>
</div>
</div>
</div>
<div class="section" id="class-reference">
<h2><a class="toc-backref" href="#id4">Class Reference</a><a class="headerlink" href="#class-reference" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="CI_Zip">
<em class="property">class </em><tt class="descname">CI_Zip</tt><a class="headerlink" href="#CI_Zip" title="Permalink to this definition">¶</a></dt>
<dd><dl class="method">
<dt id="CI_Zip.add_data">
<tt class="descname">add_data</tt><big>(</big><em>$filepath</em><span class="optional">[</span>, <em>$data = NULL</em><span class="optional">]</span><big>)</big><a class="headerlink" href="#CI_Zip.add_data" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>$filepath</strong> (<em>mixed</em>) &#8211; A single file path or an array of file =&gt; data pairs</li>
<li><strong>$data</strong> (<em>array</em>) &#8211; File contents (ignored if $filepath is an array)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">void</p>
</td>
</tr>
</tbody>
</table>
<p>Adds data to the Zip archive. Can work both in single and multiple files mode.</p>
<p>When adding a single file, the first parameter must contain the name you would like given to the file and the second must contain the file contents:</p>
<div class="highlight-ci"><pre>$name = 'mydata1.txt';
$data = 'A Data String!';
$this-&gt;zip-&gt;add_data($name, $data);

$name = 'mydata2.txt';
$data = 'Another Data String!';
$this-&gt;zip-&gt;add_data($name, $data);</pre>
</div>
<p>When adding multiple files, the first parameter must contain <em>file =&gt; contents</em> pairs and the second parameter is ignored:</p>
<div class="highlight-ci"><pre>$data = array(
        'mydata1.txt' =&gt; 'A Data String!',
        'mydata2.txt' =&gt; 'Another Data String!'
);

$this-&gt;zip-&gt;add_data($data);</pre>
</div>
<p>If you would like your compressed data organized into sub-directories, simply include the path as part of the filename(s):</p>
<div class="highlight-ci"><pre>$name = 'personal/my_bio.txt';
$data = 'I was born in an elevator...';

$this-&gt;zip-&gt;add_data($name, $data);</pre>
</div>
<p>The above example will place my_bio.txt inside a folder called personal.</p>
</dd></dl>

<dl class="method">
<dt id="CI_Zip.add_dir">
<tt class="descname">add_dir</tt><big>(</big><em>$directory</em><big>)</big><a class="headerlink" href="#CI_Zip.add_dir" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>$directory</strong> (<em>mixed</em>) &#8211; Directory name string or an array of multiple directories</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">void</td>
</tr>
</tbody>
</table>
<p>Permits you to add a directory. Usually this method is unnecessary since you can place your data into directories when using
<tt class="docutils literal"><span class="pre">$this-&gt;zip-&gt;add_data()</span></tt>, but if you would like to create an empty directory you can do so:</p>
<div class="highlight-ci"><pre>$this-&gt;zip-&gt;add_dir('myfolder'); // Creates a directory called "myfolder"</pre>
</div>
</dd></dl>

<dl class="method">
<dt id="CI_Zip.read_file">
<tt class="descname">read_file</tt><big>(</big><em>$path</em><span class="optional">[</span>, <em>$archive_filepath = FALSE</em><span class="optional">]</span><big>)</big><a class="headerlink" href="#CI_Zip.read_file" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>$path</strong> (<em>string</em>) &#8211; Path to file</li>
<li><strong>$archive_filepath</strong> (<em>mixed</em>) &#8211; New file name/path (string) or (boolean) whether to maintain the original filepath</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">TRUE on success, FALSE on failure</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">bool</p>
</td>
</tr>
</tbody>
</table>
<p>Permits you to compress a file that already exists somewhere on your server.
Supply a file path and the zip class will read it and add it to the archive:</p>
<div class="highlight-ci"><pre>$path = '/path/to/photo.jpg';

$this-&gt;zip-&gt;read_file($path);

// Download the file to your desktop. Name it "my_backup.zip"
$this-&gt;zip-&gt;download('my_backup.zip');</pre>
</div>
<p>If you would like the Zip archive to maintain the directory structure of
the file in it, pass TRUE (boolean) in the second parameter. Example:</p>
<div class="highlight-ci"><pre>$path = '/path/to/photo.jpg';

$this-&gt;zip-&gt;read_file($path, TRUE);

// Download the file to your desktop. Name it "my_backup.zip"
$this-&gt;zip-&gt;download('my_backup.zip');</pre>
</div>
<p>In the above example, photo.jpg will be placed into the <em>path/to/</em> directory.</p>
<p>You can also specify a new name (path included) for the added file on the fly:</p>
<div class="highlight-ci"><pre>$path = '/path/to/photo.jpg';
$new_path = '/new/path/some_photo.jpg';

$this-&gt;zip-&gt;read_file($path, $new_path);

// Download ZIP archive containing /new/path/some_photo.jpg
$this-&gt;zip-&gt;download('my_archive.zip');</pre>
</div>
</dd></dl>

<dl class="method">
<dt id="CI_Zip.read_dir">
<tt class="descname">read_dir</tt><big>(</big><em>$path</em><span class="optional">[</span>, <em>$preserve_filepath = TRUE</em><span class="optional">[</span>, <em>$root_path = NULL</em><span class="optional">]</span><span class="optional">]</span><big>)</big><a class="headerlink" href="#CI_Zip.read_dir" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>$path</strong> (<em>string</em>) &#8211; Path to directory</li>
<li><strong>$preserve_filepath</strong> (<em>bool</em>) &#8211; Whether to maintain the original path</li>
<li><strong>$root_path</strong> (<em>string</em>) &#8211; Part of the path to exclude from the archive directory</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">TRUE on success, FALSE on failure</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">bool</p>
</td>
</tr>
</tbody>
</table>
<p>Permits you to compress a directory (and its contents) that already exists somewhere on your server.
Supply a path to the directory and the zip class will recursively read and recreate it as a Zip archive.
All files contained within the supplied path will be encoded, as will any sub-directories contained within it. Example:</p>
<div class="highlight-ci"><pre>$path = '/path/to/your/directory/';

$this-&gt;zip-&gt;read_dir($path);

// Download the file to your desktop. Name it "my_backup.zip"
$this-&gt;zip-&gt;download('my_backup.zip');</pre>
</div>
<p>By default the Zip archive will place all directories listed in the first parameter inside the zip.
If you want the tree preceding the target directory to be ignored you can pass FALSE (boolean) in the second parameter. Example:</p>
<div class="highlight-ci"><pre>$path = '/path/to/your/directory/';

$this-&gt;zip-&gt;read_dir($path, FALSE);</pre>
</div>
<p>This will create a ZIP with a directory named &#8220;directory&#8221; inside, then all sub-directories stored correctly inside that, but will not include the
<em>/path/to/your</em> part of the path.</p>
</dd></dl>

<dl class="method">
<dt id="CI_Zip.archive">
<tt class="descname">archive</tt><big>(</big><em>$filepath</em><big>)</big><a class="headerlink" href="#CI_Zip.archive" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>$filepath</strong> (<em>string</em>) &#8211; Path to target zip archive</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">TRUE on success, FALSE on failure</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">bool</td>
</tr>
</tbody>
</table>
<p>Writes the Zip-encoded file to a directory on your server. Submit a valid server path ending in the file name.
Make sure the directory is writable (660 or 666 is usually OK). Example:</p>
<div class="highlight-ci"><pre>$this-&gt;zip-&gt;archive('/path/to/folder/myarchive.zip'); // Creates a file named myarchive.zip</pre>
</div>
</dd></dl>

<dl class="method">
<dt id="CI_Zip.download">
<tt class="descname">download</tt><big>(</big><em>$filename = 'backup.zip'</em><big>)</big><a class="headerlink" href="#CI_Zip.download" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>$filename</strong> (<em>string</em>) &#8211; Archive file name</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">void</td>
</tr>
</tbody>
</table>
<p>Causes the Zip file to be downloaded from your server. You must pass the name you would like the zip file called. Example:</p>
<div class="highlight-ci"><pre>$this-&gt;zip-&gt;download('latest_stuff.zip'); // File will be named "latest_stuff.zip"</pre>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Do not display any data in the controller in which you call
this method since it sends various server headers that cause the
download to happen and the file to be treated as binary.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="CI_Zip.get_zip">
<tt class="descname">get_zip</tt><big>(</big><big>)</big><a class="headerlink" href="#CI_Zip.get_zip" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">Zip file content</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">string</td>
</tr>
</tbody>
</table>
<p>Returns the Zip-compressed file data. Generally you will not need this method unless you want to do something unique with the data. Example:</p>
<div class="highlight-ci"><pre>$name = 'my_bio.txt';
$data = 'I was born in an elevator...';

$this-&gt;zip-&gt;add_data($name, $data);

$zip_file = $this-&gt;zip-&gt;get_zip();</pre>
</div>
</dd></dl>

<dl class="method">
<dt id="CI_Zip.clear_data">
<tt class="descname">clear_data</tt><big>(</big><big>)</big><a class="headerlink" href="#CI_Zip.clear_data" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">void</td>
</tr>
</tbody>
</table>
<p>The Zip class caches your zip data so that it doesn&#8217;t need to recompile the Zip archive for each method you use above.
If, however, you need to create multiple Zip archives, each with different data, you can clear the cache between calls. Example:</p>
<div class="highlight-ci"><pre>$name = 'my_bio.txt';
$data = 'I was born in an elevator...';

$this-&gt;zip-&gt;add_data($name, $data);
$zip_file = $this-&gt;zip-&gt;get_zip();

$this-&gt;zip-&gt;clear_data();

$name = 'photo.jpg';
$this-&gt;zip-&gt;read_file("/path/to/photo.jpg"); // Read the file's contents

$this-&gt;zip-&gt;download('myphotos.zip');</pre>
</div>
</dd></dl>

</dd></dl>

</div>
</div>


		</div>

		<!-- {user_guide_comments} -->
		
		<div id="footer">
			<p class="top"><a href="#header" title="Return to top">Return to top</a></p>
			<p><a href="http://codeigniter.com/">CodeIgniter</a> &ndash; Copyright &copy; 2013, EllisLab, Inc.</a></p>
		</div><!-- /#footer -->
	</body>
</html>